# id: akao:rule:enforcement:security_policy:v1
# name: Security Policy Enforcement
# description: Enforce security policies for sensitive files
# category: enforcement
# severity: error
# @phases: ["enforcement"]

# Enforcement phase - strict security policy adherence
# This rule enforces organizational security policies
forall $file in filesystem.get_cpp_files("."): 
    string.contains(filesystem.read_file($file), "password") == false &&
    string.contains(filesystem.read_file($file), "secret") == false &&
    string.contains(filesystem.read_file($file), "private_key") == false